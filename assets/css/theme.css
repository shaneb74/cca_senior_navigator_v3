/* Suppress Streamlit error styling to prevent red borders and backgrounds */
/* These rules ensure consistent theming even when background exceptions occur */
.stTextInput > div > div > input[aria-invalid="true"],
.stTextArea > div > div > textarea[aria-invalid="true"],
.stSelectbox > div > div[aria-invalid="true"],
.stMultiSelect > div > div[aria-invalid="true"],
.stNumberInput > div > div > input[aria-invalid="true"] {
    border-color: var(--muted) !important;
    background-color: var(--card) !important;
}

/* Suppress error styling on buttons */
.stButton > button[aria-invalid="true"],
.stButton > button[data-testid="baseButton-primary"][aria-invalid="true"] {
    background-color: var(--brand) !important;
    border-color: var(--brand) !important;
    color: #fff !important;
}

/* Hide error messages and exception details that may cause red styling */
.stException,
.stAlert[data-baseweb="notification"][kind="error"] {
    display: none !important;
}

/* Streamlit overrides for better selection visibility */
.stRadio label[data-baseweb="radio"] input:checked + div {
    background-color: var(--brand-50) !important;
    border-color: var(--brand) !important;
    color: var(--ink) !important;
    font-weight: bold !important;
}

.stMultiSelect .stMultiSelectBox {
    border-color: var(--brand) !important;
}

.stMultiSelect .stMultiSelectBox[data-baseweb="select"] div[aria-selected="true"] {
    background-color: var(--brand-50) !important;
    color: var(--ink) !important;
}

/* Fix progress bar contrast */
.stProgress > div > div > div {
    background-color: var(--brand) !important;
}

.stProgress > div > div {
    background-color: var(--muted) !important;
}

/* Fix select dropdown contrast */
.stSelectbox [data-baseweb="select"] > div {
    background-color: var(--card) !important;
    color: var(--ink) !important;
}

.stSelectbox [data-baseweb="select"] [data-baseweb="popover"] div {
    background-color: var(--card) !important;
    color: var(--ink) !important;
}

.stSelectbox [data-baseweb="select"] [data-baseweb="popover"] div:hover {
    background-color: var(--brand-50) !important;
}

/* Style st.button to match .btn classes */
.stButton > button {
    display: inline-block;
    font-weight: 600;
    border-radius: var(--radius);
    padding: 12px 20px;
    min-height: 44px;
    text-align: center;
    cursor: pointer;
    text-decoration: none;
    transition: background 0.2s, color 0.2s, border-color 0.2s, box-shadow 0.2s;
    border: 1px solid var(--brand);
    background: var(--brand);
    color: #fff;
}

.stButton > button:hover {
    background: var(--brand-400, #6BA8FF);
    color: #fff;
    border-color: var(--brand-400, #6BA8FF);
}

.stButton > button:active {
    background: var(--brand-700, #0043b8);
    color: #fff;
    border-color: var(--brand-700, #0043b8);
}

/* Tokens */
:root{
  /* Brand */
  --brand:#0B5CD8; --brand-400:#6BA8FF; --brand-50:#E6EEFF;

  /* Ink */
  --ink:#0F172A; --ink-600:#475569; --ink-500:#64748B; --ink-300:#94A3B8;

  /* Surfaces */
  --bg:#F7F9FC; --card:#FFFFFF; --muted:#F1F5F9;

  /* States */
  --success:#22C55E; --warning:#F59E0B; --danger:#EF4444; --info:#3B82F6;

  /* Radius */
  --radius-sm:10px; --radius:14px; --radius-lg:20px;

  /* Shadows */
  --shadow-sm:0 1px 2px rgba(2,6,23,0.06), 0 1px 1px rgba(2,6,23,0.04);
  --shadow-md:0 6px 12px rgba(2,6,23,0.08), 0 2px 4px rgba(2,6,23,0.06);
  --shadow-lg:0 18px 32px rgba(2,6,23,0.12), 0 6px 12px rgba(2,6,23,0.08);

  /* Type */
  --font-sans: ui-sans-serif, system-ui, "Inter", "DM Sans", -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
  --fs-root:18px; --lh:1.5;

  /* Spacing scale (0..16 => 0..64px) */
  --space-0:0; --space-1:4px; --space-2:8px; --space-3:12px; --space-4:16px; --space-5:20px;
  --space-6:24px; --space-7:28px; --space-8:32px; --space-9:36px; --space-10:40px;
  --space-12:48px; --space-14:56px; --space-16:64px;

  /* Motion */
  --easing:cubic-bezier(.2,.7,.2,1);
  --focus-ring:0 0 0 3px rgba(107,168,255,.45);
}

html, body { font-size:var(--fs-root); background:var(--bg); color:var(--ink); font-family:var(--font-sans); line-height:var(--lh); }
* { box-sizing:border-box; }

/* Global Streamlit overrides for consistent theming */
.stApp {
    background: var(--bg) !important;
}

.main .block-container {
    background: var(--bg) !important;
    color: var(--ink) !important;
}

.stSidebar {
    background: var(--card) !important;
}

.stMarkdown, .stText, .stTitle, .stHeader, .stSubheader {
    color: var(--ink) !important;
}

.stRadio label, .stCheckbox label, .stSelectbox label, .stMultiselect label, .stSlider label {
    color: var(--ink) !important;
}

/* Ensure all backgrounds use theme colors */
.stTextInput > div > div, .stNumberInput > div > div, .stTextArea > div > div {
    background: var(--card) !important;
    border-color: var(--ink-300) !important;
}

.stTextInput > div > div:focus, .stNumberInput > div > div:focus, .stTextArea > div > div:focus {
    border-color: var(--brand-400) !important;
    box-shadow: var(--focus-ring) !important;
}

/* Radio buttons styling */
.stRadio > div {
    background: transparent !important;
}

.stRadio label[data-baseweb="radio"] > div:first-child {
    background: var(--card) !important;
    border-color: var(--ink-300) !important;
}

.stRadio label[data-baseweb="radio"] input:checked + div {
    background-color: var(--brand-50) !important;
    border-color: var(--brand) !important;
    color: var(--ink) !important;
}

.stRadio label[data-baseweb="radio"] input:checked + div > div {
    color: var(--ink) !important;
}

/* Global text and title styling */
.stTitle, .stHeader, .stSubheader, .stMarkdown h1, .stMarkdown h2, .stMarkdown h3 {
    color: var(--ink) !important;
}

.stMarkdown p, .stMarkdown li, .stText {
    color: var(--ink) !important;
}

/* Ensure all containers use theme backgrounds */
.stContainer, .stVerticalBlock {
    background: transparent !important;
}

/* Progress bars */
.stProgress > div {
    background: var(--muted) !important;
}

.stProgress > div > div > div {
    background: var(--brand) !important;
}

/* Sliders */
.stSlider > div > div > div {
    background: var(--brand) !important;
}

/* Links */
a { color:var(--brand); text-decoration:none; }
a:hover { text-decoration:underline; }

/* Containers & layout */
.container { max-width:1200px; margin:0 auto; padding:0 var(--space-6); }
.stack > * + * { margin-top: var(--space-6); }
.cluster { display:flex; gap:var(--space-4); align-items:center; flex-wrap:wrap; }
.grid { display:grid; gap:var(--space-6); grid-template-columns: repeat(12, 1fr); }
@media (max-width: 1024px){ .grid{ grid-template-columns: repeat(8,1fr);} }
@media (max-width: 640px){ .grid{ grid-template-columns: repeat(4,1fr);} }

/* Header / Footer */
.header { background:var(--card); box-shadow:var(--shadow-sm); position:sticky; top:0; z-index: 100; }
.header__inner, .footer__inner { display:flex; align-items:center; justify-content:space-between; padding: var(--space-4) 0; }
.brand { font-weight:700; color:var(--ink); }
.nav-link { padding:8px 10px; border-radius:var(--radius-sm); color:var(--ink-600); }
.nav-link:hover { background:var(--brand-50); color:var(--brand); transition: all .2s var(--easing); }
.nav-link.is-active { background:var(--brand-50); color:var(--brand); }
.footer { margin-top: var(--space-12); background:var(--muted); color:var(--ink-500); }

/* Buttons */
.btn {
  display:inline-block;
  font-weight:600;
  border-radius:var(--radius);
  padding:12px 20px;
  min-height:44px;
  text-align:center;
  cursor:pointer;
  text-decoration:none;
  transition:background .2s, color .2s, border-color .2s, box-shadow .2s;
}
.btn:focus-visible { outline: none; box-shadow: var(--focus-ring); }

.btn--primary,
.btn--primary:link,
.btn--primary:visited {
  background: var(--brand);
  color: #fff;
  border: 1px solid var(--brand);
  text-decoration: none;
}
.btn--primary:hover,
.btn--primary:focus {
  background: var(--brand-700, #0043b8);
  color: #fff;
  border-color: var(--brand-700, #0043b8);
  outline: none;
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--brand) 25%, transparent);
}
.btn--primary:active {
  background: var(--brand-800, #00389a);
  color: #fff;
  border-color: var(--brand-800, #00389a);
}
.btn--primary * { color: inherit; }

.btn--secondary {
  background:var(--card);
  color:var(--brand);
  border:1px solid var(--brand);
}
.btn--secondary:hover,
.btn--secondary:focus {
  background: var(--brand-50, #e6eeff);
  color: var(--brand-700, #0043b8);
  border-color: var(--brand-700, #0043b8);
}

.btn--ghost {
  background:transparent;
  color:var(--brand);
  border:1px solid transparent;
}
.btn--ghost:hover,
.btn--ghost:focus {
  color: var(--brand-700, #0043b8);
}

.btn--success { background:var(--success); color:#fff; }

/* Cards */
/* Cards */
.card { background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding: var(--space-5); box-shadow:var(--shadow-sm); }
.card--hover:hover { box-shadow:var(--shadow-md); transition: box-shadow .2s var(--easing); }
.card-head { font-weight:600; margin-bottom:var(--space-3); }
.card-meta { color:var(--ink-500); margin-bottom:var(--space-4); }
.card-actions { display:flex; gap:var(--space-4); }

/* Chips / Tags */
.chip { display:inline-flex; align-items:center; gap:8px; padding:2px 10px; border-radius:999px; background:var(--muted); color:var(--ink-600); }
.status .dot { width:8px; height:8px; border-radius:999px; display:inline-block; background:var(--ink-300); }
.status.success .dot{ background:var(--success); }
.status.warning .dot{ background:var(--warning); }
.status.danger .dot{ background:var(--danger); }

/* Banners */
.banner { border-left:4px solid var(--brand); background:var(--card); padding: var(--space-5); border-radius:var(--radius); box-shadow:var(--shadow-sm); }
.banner--info { border-color: var(--info); }
.banner--success { border-color: var(--success); }
.banner--warning { border-color: var(--warning); }
.banner--danger { border-color: var(--danger); }

/* Forms */
.field { display:flex; flex-direction:column; gap:6px; }
.field label { font-weight:600; color:var(--ink); }
.input, .select, .textarea { width:100%; min-height:44px; border-radius:var(--radius-sm); border:1px solid var(--ink-300); background:var(--card); padding:10px 12px; color:var(--ink); }
.textarea { min-height:96px; }
.input:focus, .select:focus, .textarea:focus { outline:none; box-shadow: var(--focus-ring); border-color: var(--brand-400); }
.helper { color:var(--ink-500); font-size:0.95rem; }

/* Choice pills (for radios) */
.choice-pills { display:flex; gap:8px; flex-wrap:wrap; }
.choice-pills .pill { padding:8px 12px; border-radius:999px; border:1px solid var(--ink-300); cursor:pointer; }
.choice-pills .pill.is-selected { background:var(--brand-50); border-color:var(--brand-400); color:var(--brand); }

/* Steps */
.steps { display:flex; gap:10px; flex-wrap:wrap; }
.step { padding:6px 10px; border-radius:999px; background:var(--muted); color:var(--ink-600); }
.step.is-active { background:var(--brand-50); color:var(--brand); }
.step.is-done { background:#e2fbe2; color:#137a2e; }

/* Modal / Toast (structural hooks) */
.modal { position:fixed; inset:0; display:grid; place-items:center; background:rgba(15,23,42,.35); }
.modal .panel { background:var(--card); border-radius:var(--radius-lg); box-shadow:var(--shadow-lg); padding:var(--space-8); transform:scale(.96); animation:modalIn .3s var(--easing) forwards; }
@keyframes modalIn { to { transform:scale(1); } }
.toast { position:fixed; bottom:24px; right:24px; background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow-md); padding:12px 16px; }

/* Accessibility */
*:focus-visible { outline: none; box-shadow: var(--focus-ring); }
@media (prefers-reduced-motion: reduce){
  * { animation:none !important; transition:none !important; }
}

/* Utilities */
.grid-span-4 { grid-column: span 4; }
.grid-span-5 { grid-column: span 5; }
.grid-span-6 { grid-column: span 6; }
.grid-span-7 { grid-column: span 7; }
.grid-span-8 { grid-column: span 8; }
.text-center { text-align:center; }
.mt-space-3 { margin-top: var(--space-3); }
.mt-space-4 { margin-top: var(--space-4); }
.mt-space-6 { margin-top: var(--space-6); }
.list-unstyled { list-style:none; margin:0; padding:0; }
.img-responsive { max-width:100%; height:auto; display:inline-block; }
.img-rounded { border-radius:var(--radius); }
.stack-sm > * + * { margin-top: var(--space-4); }
.stack-xs > * + * { margin-top: var(--space-3); }

@media (max-width: 1024px){
  .grid-span-4,
  .grid-span-5,
  .grid-span-6,
  .grid-span-7,
  .grid-span-8 { grid-column: span 8; }
}

@media (max-width: 640px){
  .grid-span-4,
  .grid-span-5,
  .grid-span-6,
  .grid-span-7,
  .grid-span-8 { grid-column: span 4; }
}

/* Hubs/Dashboard */
.section { padding: var(--space-10) 0; }
.section-title { letter-spacing: 0.06em; font-weight: 800; }
.tiles { display: grid; gap: var(--space-6); grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
.tiles-2x2 { display: grid; gap: var(--space-6); grid-template-columns: repeat(2, 1fr); }
.tile { background: var(--card); border-radius: var(--radius); box-shadow: var(--shadow-sm); padding: var(--space-6); }
.tile--lg { grid-column: span 2; }
.tile--new .badge { background: var(--muted); color: var(--ink-600); }
.tile--doing .badge { background: var(--warning); color: #fff; }
.tile--done .badge { background: var(--success); color: #fff; }
.tile--locked .badge { background: var(--muted); color: var(--ink-300); }
.tile-progress { margin: var(--space-4) 0; }
.progress-bar { height: 8px; background: var(--muted); border-radius: 4px; overflow: hidden; }
.progress-bar > div { height: 100%; background: var(--brand); transition: width 0.3s; }
.tile-head { display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4); }
.tile-title { font-weight: 700; }
.tile-meta { color: var(--ink-500); }
.kit-row { display: flex; gap: var(--space-4); align-items: center; flex-wrap: wrap; }

/* Badges */
.badge { background: var(--muted); color: var(--ink-600); padding: 4px 8px; border-radius: 999px; font-size: 0.9rem; display: inline-flex; gap: 8px; align-items: center; }
.badge.success { background: #e9f9ee; color: #137a2e; }
.badge.info { background: #e6eeff; color: var(--brand); }
.badge.warning { background: #fef3c7; color: #92400e; }

/* Q&A */
.qa { display: grid; gap: var(--space-4); }
.qa-item { background: var(--card); border-radius: var(--radius); box-shadow: var(--shadow-sm); padding: var(--space-5); }
.qa-q { font-weight: 600; }
.qa-a { color: var(--ink-600); }

/* Inline steps */
.inline-steps { display: flex; gap: 10px; flex-wrap: wrap; }
.inline-steps .step { padding: 6px 10px; border-radius: 999px; background: var(--muted); color: var(--ink-600); }
.inline-steps .step.is-active { background: var(--brand-50); color: var(--brand); }
.inline-steps .step.is-done { background: #e2fbe2; color: #137a2e; }

/* Mobile bottom nav */
.mnav { position: fixed; bottom: 0; left: 0; right: 0; background: var(--card); box-shadow: var(--shadow-md); }
.mnav .bar { max-width: 1200px; margin: 0 auto; padding: var(--space-3) var(--space-6); display: flex; justify-content: space-around; }
.mnav a { display: flex; flex-direction: column; align-items: center; gap: 6px; font-size: 0.9rem; color: var(--ink-600); }
.mnav a.is-active { color: var(--brand); }
@media (min-width: 900px){ .mnav { display: none; } }

/* Responsive */
@media (max-width: 640px){
  .tiles { grid-template-columns: 1fr; }
  .tiles-2x2 { grid-template-columns: 1fr; }
}

/* Utilities for hero + contextual */
.section-hero { padding: var(--space-12) 0; }
.hero-grid { display: grid; grid-template-columns: 1.1fr 0.9fr; gap: var(--space-10); align-items: center; }
.hero-eyebrow { letter-spacing: 0.08em; font-weight: 600; color: var(--ink-500); }
.hero-title { font-size: clamp(2rem, 4vw, 3rem); font-weight: 800; line-height: 1.15; }
.hero-sub { color: var(--ink-600); max-width: 48ch; }
.cta-row { display: flex; gap: var(--space-4); margin-top: var(--space-6); }
.cards-2 { display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-8); }
.card-photo { border-radius: var(--radius); width: 100%; height: auto; display: block; }
.canvas-soft { background: #E6EEFF; }
.center-wrap { display: grid; grid-template-columns: 0.9fr 1.1fr; gap: var(--space-10); align-items: center; min-height: 72vh; }
.modal-card { background: var(--card); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); padding: var(--space-8); max-width: 520px; }
.toggle { display: flex; gap: 8px; }
.toggle .pill { padding: 8px 12px; border-radius: 999px; border: 1px solid var(--ink-300); cursor: pointer; }
.toggle .pill.is-selected { background: var(--ink); color: #fff; border-color: var(--ink); }
.helper-note { background: var(--brand-50); padding: var(--space-4); border-radius: var(--radius); color: var(--ink-600); }
.photo-stack { position: relative; width: 100%; }
.photo-stack img { position: absolute; width: 66%; max-width: 520px; border-radius: 14px; box-shadow: var(--shadow-md); }
.photo-back { top: -8%; left: 12%; transform: rotate(-6deg); }
.photo-front { top: 14%; left: 28%; transform: rotate(8deg); }
@media (max-width: 900px){
  .hero-grid,
  .cards-2,
  .center-wrap { grid-template-columns: 1fr; }
  .photo-stack { height: 380px; }
  .photo-back,
  .photo-front { position: absolute; left: 50%; transform: translateX(-50%) rotate(0); width: 86%; }
  .photo-back { top: 0; }
  .photo-front { top: 32%; }
}

/* Dark theme */
.theme-dark {
  --bg:#0b1220; --card:#0f172a; --muted:#111827;
  --ink:#e5e7eb; --ink-600:#c7cdd7; --ink-500:#aab3c2; --ink-300:#9099a8;
  --shadow-sm:0 1px 2px rgba(0,0,0,.3);
  --shadow-md:0 6px 12px rgba(0,0,0,.45);
  --shadow-lg:0 18px 32px rgba(0,0,0,.6);
}
